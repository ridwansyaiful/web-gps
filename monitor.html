<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Monitoring Lokasi dengan OpenLayers</title>
    <link rel="stylesheet" href="https://openlayers.org/en/latest/css/ol.css" />
    <style>
        #map {
            height: 400px;
            width: 100%;
        }
    </style>
</head>
<body>
    <h1>Sistem Monitoring Lokasi</h1>
    <div id="map" class="map"></div>

    <script src="https://openlayers.org/en/latest/build/ol.js"></script>
    <script>
        // Inisialisasi peta
        const map = new ol.Map({
            target: 'map',
            layers: [
                new ol.layer.Tile({
                    source: new ol.source.OSM()
                })
            ],
            view: new ol.View({
                center: ol.proj.fromLonLat([106.8456, -6.2001]), // [lng, lat]
                zoom: 13
            })
        });

        // Mendapatkan lokasi pengguna
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.watchPosition(showPosition, showError);
            } else {
                alert("Geolocation tidak didukung oleh browser ini.");
            }
        }

        function showPosition(position) {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;

            // Pindahkan peta ke lokasi baru
            map.setView(new ol.View({
                center: ol.proj.fromLonLat([lon, lat]),
                zoom: 13
            }));

            // Tambahkan marker lokasi pengguna
            new ol.Overlay({
                element: document.createElement('div'),
                positioning: 'bottom-center',
                stopEvent: false
            }).setPosition(ol.proj.fromLonLat([lon, lat]));

            const markerElement = document.createElement('div');
            markerElement.className = 'marker';
            markerElement.style.backgroundColor = 'red';
            markerElement.style.width = '10px';
            markerElement.style.height = '10px';
            markerElement.style.borderRadius = '50%';
            markerElement.style.position = 'absolute';
            markerElement.style.transform = 'translate(-50%, -50%)';
            document.body.appendChild(markerElement);
        }

        function showError(error) {
            console.error("Error mendapatkan lokasi:", error);
        }

        // Mulai mendapatkan lokasi saat halaman dimuat
        window.onload = getLocation;
    </script>
</body>
</html>
